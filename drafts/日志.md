# 日志
* 可以将日志存储到es、mysql、sqlite、日志文件（file、stdout、pipe，格式：string, json、yaml）、API、socket、syslog中
* 可以按照规则分卷：时间、日期、大小、记录数 
* 提供日志存储接口
* 可使用关键词实时筛选
* 可记录应用层的日志
* 可支持变量
* 输入过滤条件时可以自动补全，比如chrome/firefox，并提示可能错误的单词（spelling check）
* 提交错误分析报告：当日志分析错误的时候，可以把分析的信息发送到TeaWeb官方
* 清除日志功能
* 日志预览功能：图片、HTML、CSS、zip，显示文件icon
* 日志增加代理ID，可以查看单个代理的所有日志
* 每个代理都有单独的操作日志、错误日志、访问日志
* 访问日志：今日峰值、历史峰值、图表（按月、周、天、小时）
* 日志增加实时获取response/post参数
* accesslog读取POST内容
* 访问日志：今日峰值、历史峰值、图表（按月、周、天、小时）
* errors支持index，比如多个重名元素发生错误
* 日志增加暂停/继续
* 提升日志性能
* 在代理管理中增加"日志" Tab，可以查看代理的操作后的日志
* 日志设置有效期：比如1天，30天，当月等
* 日志设置条数：比如10000条/代理服务，总200000条
* 日志详情中增加统计图表
* 每个后端可以单独看日志
* 每个代理都有单独的操作日志、错误日志、访问日志

# 格式
* format <string> 字符串
* format [json|yaml] 输出json或yaml格式

# 过程
~~~
Request --> Channel  --> | es, mysql, sqlite ... | 
~~~

# 界面
~~~
实时日志 | 日志设置  |
--------------------
|-------------------------------------------------|
|                                                 
|   QPS            共              成功           失败
|   12           1024            1000            24
|   req/s        个请求           个请求          个请求
|
|-------------------------------------------------|

|----------------------------|
| 输入过滤条件                      浏览器：... 操作系统 ... 文件类型 ... [更多...]
|----------------------------|

---------------------------------------------------------------|
| $remoteAddr - $timeISO8601 - $host - $request - $userAgent - $bytesSent - $requestTime - [API] [更多 ...]
|           远程地址（RemoteAddr）:...
|           时间（$timeISO8601）:...
|           浏览器：....
|           ...
|           附加资源：
|                http://xxx/xxx.js
|                http://xxx/xxx.css
|                [更多(16) ...]
|           操作：[添加到API] [提交分析错误]
|--------------------------------------------------------------|

~~~
其中`[API]`标记是否为API，如果是API可以点击到API详情页


# 筛选
参考各个日志分析平台：
* Azure: https://docs.microsoft.com/en-us/azure/log-analytics/log-analytics-overview
* Logstash: https://www.elastic.co/products/logstash
* Google Cloud: Access Logs & Storage Logs: https://cloud.google.com/storage/docs/access-logs

支持的筛选条件：
* ip: 单个IP、多个IP
    * 地域
* 域名/主机名
* 头信息
* UserAgent:
    * 浏览器
    * 操作系统
* 自定义头消息
    * 用户信息相关
* 文件类型：
    * 扩展名：.php/.html/.py/.js/...
    * mime type：image/jpeg, text/html, ...
    * 分组：文档、图片、压缩包、...
* 时间：月、周、天
* 请求花费时间
* 内容长度
* 状态码
* 参数
* 请求方法
* 请求路径
* 来源referer
* cookie         

* 筛选条件可以保存，以备重复使用。
* 突出高耗时请求
* 实时流量